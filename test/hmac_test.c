#include <string.h>

#include "hash.h"
#include "hmac.h"

int main(void)
{
  byte k[] = "key";
  byte m[] = "The quick brown fox jumps over the lazy dog";
  byte expected[] = {
    0xf7, 0xbc, 0x83, 0xf4, 0x30, 0x53, 0x84, 0x24,
    0xb1, 0x32, 0x98, 0xe6, 0xaa, 0x6f, 0xb1, 0x43,
    0xef, 0x4d, 0x59, 0xa1, 0x49, 0x46, 0x17, 0x59,
    0x97, 0x47, 0x9d, 0xbc, 0x2d, 0x1a, 0x3c, 0xd8
  };
  byte actual[sizeof expected];

  hmac_digest(&sha256_defn, k, (sizeof k)-1, m, (sizeof m)-1, actual);

  if (memcmp(actual, expected, sizeof actual) != 0) {
    return 1;
  }

  return 0;
}
